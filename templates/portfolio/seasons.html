{% extends 'base.html' %}

{% block title %}정원의 사계 | 순천만 국제정원{% endblock %}

{% block content %}
<section class="max-w-6xl mx-auto px-6 py-16">
    <style>
        .season-bg {
            position: absolute;
            inset: 0;
            z-index: 0;
        }
        .season-bg.spring {
            background: linear-gradient(180deg, rgba(254, 242, 248, 0.95) 0%, rgba(255, 247, 237, 0.9) 100%);
        }
        .season-bg.summer {
            background: linear-gradient(180deg, rgba(239, 246, 255, 0.95) 0%, rgba(224, 242, 254, 0.9) 100%);
        }
        .season-bg.autumn {
            background: linear-gradient(180deg, rgba(255, 247, 237, 0.95) 0%, rgba(254, 243, 199, 0.9) 100%);
        }
        .season-bg.winter {
            background: linear-gradient(180deg, rgba(248, 250, 252, 0.95) 0%, rgba(241, 245, 249, 0.95) 100%);
        }
        .season-word {
            font-size: clamp(4rem, 14vw, 10rem);
            letter-spacing: 0.1em;
        }
        .season-icon {
            width: 72px;
            height: 72px;
        }
        @media (max-width: 768px) {
            .season-icon {
                width: 56px;
                height: 56px;
            }
            .season-icon-mobile {
                position: static !important;
                margin-bottom: 1rem;
            }
        }
        .season-overlay {
            position: absolute;
            inset: 0;
            pointer-events: none;
            overflow: hidden;
            z-index: 1;
        }
        .season-content {
            position: relative;
            z-index: 2;
        }
        .season-particle {
            position: absolute;
            top: -10%;
            border-radius: 9999px;
            opacity: 0.7;
            animation: seasonal-fall linear infinite;
        }
        .season-particle.spring-petal {
            border-radius: 70% 30% 65% 35%;
            background: linear-gradient(145deg, rgba(251, 207, 232, 0.95), rgba(244, 114, 182, 0.6));
            box-shadow: inset -1px -1px 0 rgba(255, 255, 255, 0.55);
        }
        .season-particle.autumn-leaf {
            border-radius: 10% 80% 10% 80%;
            background: linear-gradient(155deg, rgba(253, 186, 116, 0.95), rgba(234, 88, 12, 0.72));
            transform-origin: 50% 70%;
        }
        .season-particle.autumn-leaf::after {
            content: '';
            position: absolute;
            left: 48%;
            top: 82%;
            width: 2px;
            height: 8px;
            background: rgba(120, 53, 15, 0.65);
            border-radius: 9999px;
        }
        .season-particle.winter-snow {
            border-radius: 0;
            background: transparent;
            box-shadow: none;
        }
        .season-particle.winter-snow::before {
            content: '❄';
            position: absolute;
            inset: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            color: rgba(148, 163, 184, 0.95);
            text-shadow: 0 0 2px rgba(255, 255, 255, 0.8), 0 0 6px rgba(148, 163, 184, 0.35);
            font-size: 1em;
            line-height: 1;
        }
        .season-overlay.summer .season-particle {
            display: none;
        }
        .season-wave {
            position: absolute;
            left: -10%;
            bottom: 0;
            width: 120%;
            border-radius: 50% 50% 0 0;
            opacity: 0.45;
            animation: wave-drift 9s ease-in-out infinite;
            display: none;
        }
        .season-overlay.summer .season-wave {
            display: block;
        }
        .season-wave.wave-1 { height: 17%; background: rgba(191, 219, 254, 0.45); }
        .season-wave.wave-2 { height: 12%; background: rgba(147, 197, 253, 0.4); animation-delay: -2.4s; }
        .season-wave.wave-3 { height: 8%; background: rgba(96, 165, 250, 0.35); animation-delay: -4.8s; }
        @keyframes seasonal-fall {
            0% { transform: translate3d(0, -5vh, 0) rotate(0deg); opacity: 0; }
            10% { opacity: 0.85; }
            100% { transform: translate3d(40px, 78vh, 0) rotate(300deg); opacity: 0; }
        }
        @keyframes wave-drift {
            0%, 100% { transform: translateX(0) translateY(0); }
            50% { transform: translateX(-4%) translateY(8px); }
        }
    </style>

    <div class="relative overflow-hidden">
        <div id="season-bg" class="season-bg" aria-hidden="true"></div>
        <div id="season-overlay" class="season-overlay" aria-hidden="true">
            <div class="season-wave wave-1"></div>
            <div class="season-wave wave-2"></div>
            <div class="season-wave wave-3"></div>
        </div>
    <div class="season-content flex flex-col lg:flex-row gap-12 items-start">
        <div class="flex-1">
            <div class="relative">
                <div class="season-icon season-icon-mobile text-gray-700 md:absolute md:-top-4 md:left-0">
                    {% if active_key == 'spring' %}
                        <svg viewBox="0 0 64 64" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M20 52c0-12 8-24 20-32" />
                            <path d="M20 52c0-12-8-24-16-30" />
                            <path d="M20 52c6-2 12-2 18 0" />
                            <circle cx="40" cy="18" r="6" />
                        </svg>
                    {% elif active_key == 'summer' %}
                        <svg viewBox="0 0 64 64" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M6 34c8-8 18-8 26 0s18 8 26 0" />
                            <path d="M6 46c8-8 18-8 26 0s18 8 26 0" />
                        </svg>
                    {% elif active_key == 'autumn' %}
                        <svg viewBox="0 0 64 64" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M32 8c8 10 8 20 0 32-8-12-8-22 0-32Z" />
                            <path d="M32 40c8-4 16-4 24 0-8 8-16 12-24 12-8 0-16-4-24-12 8-4 16-4 24 0Z" />
                        </svg>
                    {% else %}
                        <svg viewBox="0 0 64 64" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="40" cy="22" r="8" />
                            <circle cx="40" cy="40" r="12" />
                            <path d="M24 40h-8" />
                            <path d="M56 40h-8" />
                        </svg>
                    {% endif %}
                </div>
                <div class="season-word title-font text-gray-900">{{ active_label }}</div>
            </div>
            <p class="text-sm text-gray-500 mt-6">{{ active_desc }}</p>
        </div>
        <div class="w-full lg:w-64">
            <div class="flex flex-row lg:flex-col gap-4 text-sm">
                {% for item in season_nav %}
                    <a href="{% url 'portfolio:seasons' %}?season={{ item.key }}" class="flex items-center gap-3 px-3 py-2 border {% if active_key == item.key %}border-gray-900 text-gray-900{% else %}border-gray-200 text-gray-500{% endif %}">
                        <span class="w-6 h-6">
                            {% if item.key == 'spring' %}
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M12 20c0-6 4-12 8-16" />
                                    <path d="M12 20c0-6-4-12-8-15" />
                                </svg>
                            {% elif item.key == 'summer' %}
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M2 12c4-4 8-4 12 0s8 4 12 0" />
                                </svg>
                            {% elif item.key == 'autumn' %}
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M12 3c3 4 3 8 0 13-3-5-3-9 0-13Z" />
                                </svg>
                            {% else %}
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <circle cx="14" cy="8" r="4" />
                                    <circle cx="14" cy="16" r="6" />
                                </svg>
                            {% endif %}
                        </span>
                        <span>{{ item.label }}</span>
                    </a>
                {% endfor %}
            </div>
        </div>
    </div>
    </div>

    <div class="mt-16">
        {% if photo_groups %}
            {% for group in photo_groups %}
                <div class="mb-12">
                    <div class="flex items-center gap-4 mb-6">
                        <div class="text-lg title-font">{{ group.year }}</div>
                        <div class="h-px bg-gray-200 flex-1"></div>
                    </div>
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
                        {% for photo in group.photos %}
                            <article>
                                <img src="{{ photo.image.url }}" alt="{{ photo.title }}" class="w-full h-56 object-cover rounded-sm" />
                                <div class="mt-2 text-sm">{{ photo.title }}</div>
                            </article>
                        {% endfor %}
                    </div>
                </div>
            {% endfor %}
        {% else %}
            <div class="text-sm text-gray-400">아직 등록된 사진이 없습니다.</div>
        {% endif %}
    </div>
</section>
<script>
    const seasonOverlay = document.getElementById('season-overlay');
    const seasonBg = document.getElementById('season-bg');
    const activeSeason = '{{ active_key }}';

    const createParticles = (season) => {
        if (!seasonOverlay) {
            return;
        }

        seasonOverlay.classList.remove('spring', 'summer', 'autumn', 'winter');
        seasonOverlay.classList.add(season);

        seasonOverlay.querySelectorAll('.season-particle').forEach((node) => node.remove());
        if (season === 'summer') {
            return;
        }

        const config = {
            spring: { min: 8, max: 14, count: 16, shapeClass: 'spring-petal' },
            autumn: { min: 9, max: 15, count: 15, shapeClass: 'autumn-leaf' },
            winter: { min: 4, max: 9, count: 20, shapeClass: 'winter-snow' },
        }[season] || { min: 4, max: 9, count: 20, shapeClass: 'winter-snow' };

        for (let index = 0; index < config.count; index += 1) {
            const particle = document.createElement('span');
            particle.className = `season-particle ${config.shapeClass}`;

            const size = config.min + Math.random() * (config.max - config.min);
            const duration = 7 + Math.random() * 8;
            const delay = -Math.random() * duration;

            particle.style.width = `${size}px`;
            particle.style.height = `${size}px`;
            if (season === 'winter') {
                particle.style.fontSize = `${(size + 6) * 2}px`;
            }
            particle.style.left = `${Math.random() * 100}%`;
            particle.style.animationDuration = `${duration}s`;
            particle.style.animationDelay = `${delay}s`;
            seasonOverlay.appendChild(particle);
        }
    };

    const applySeasonBackground = (season) => {
        if (!seasonBg) {
            return;
        }
        seasonBg.classList.remove('spring', 'summer', 'autumn', 'winter');
        seasonBg.classList.add(season);
    };

    applySeasonBackground(activeSeason);
    createParticles(activeSeason);
</script>
{% endblock %}
